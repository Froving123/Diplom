(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{1788:function(e,t,r){Promise.resolve().then(r.t.bind(r,1127,23)),Promise.resolve().then(r.bind(r,3364)),Promise.resolve().then(r.bind(r,181))},7368:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});var s=r(3827),o=r(3744),c=r.n(o);let n=e=>(0,s.jsx)("div",{onClick:e.close,className:"".concat(c().overlay," ").concat(e.isOpened&&c()["overlay_is-opened"])})},5838:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});var s=r(3827),o=r(4487),c=r.n(o);let n=e=>(0,s.jsxs)("div",{className:"".concat(c().popup," ").concat(e.isOpened&&c()["popup_is-opened"]),children:[(0,s.jsx)("button",{onClick:e.close,className:c().close,children:(0,s.jsx)("svg",{className:c()["close-icon"],xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 25",children:(0,s.jsx)("path",{fill:"#7E8292",d:"M15.3321 18.34c.04.0667.06.1533.06.26 0 .0933-.0467.1867-.14.28-.08.08-.18.12-.3.12h-4.5c-.36 0-.63332-.1533-.81999-.46l-1.74-2.68-1.66 2.68c-.18667.3067-.46.46-.82.46h-4.36c-.120001 0-.226667-.04-.320001-.12-.08-.0933-.12-.1867-.12-.28 0-.1067.02-.1933.06-.26l4.200001-6.5-3.78-6.18c-.04-.08-.06-.16667-.06-.26s.04-.18.12-.26c.09333-.09333.2-.14.32-.14h4.34c.37333 0 .65333.16667.84.5l1.4 2.44 1.52-2.44c.18667-.33333.46669-.5.83999-.5h4.14c.12 0 .22.04667.3.14.0933.08.14.17333.14.28 0 .09333-.02.17333-.06.24l-3.86 6.12 4.26 6.56Z"})})}),(0,s.jsx)("div",{className:c().content,children:e.children})]})},181:function(e,t,r){"use strict";r.r(t),r.d(t,{Shopping_cart:function(){return l}});var s=r(3827),o=r(4090),c=r(1748),n=r(3105),i=r(3033),_=r.n(i);let l=()=>{let[e,t]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=n.I.onAuthStateChanged(e=>{e?r(e.uid):t([])});return()=>e()},[]);let r=async e=>{let r=(0,c.iH)(n.db,"product"),s=(0,c.IO)(r,(0,c.g2)("userId"),(0,c.EW)(e));try{await new Promise(e=>{(0,c.jM)(s,r=>{if(r.exists()){let s=[];r.forEach(e=>{s.push({id:e.key,...e.val()})}),t(s),e()}else console.log("Данные не найдены"),e()})})}catch(e){console.error("Ошибка при получении данных: ",e)}},i=async r=>{try{await (0,c.Od)((0,c.iH)(n.db,"product/".concat(r)));let s=e.filter(e=>e.id!==r);t(s)}catch(e){console.error("Ошибка при удалении товара: ",e)}};return(0,s.jsx)("div",{className:_().shopping_cart,children:e.length>0?(0,s.jsx)("div",{className:_().ul_product,children:e.map(e=>(0,s.jsxs)("div",{className:_().product,children:[(0,s.jsxs)("div",{className:_().product_content,children:[(0,s.jsx)("p",{className:_().product_description,children:e.name}),(0,s.jsx)("p",{className:_().product_description,children:e.price})]}),(0,s.jsx)("button",{onClick:()=>i(e.id),className:_().button_remove,children:(0,s.jsx)("p",{className:_().remove_text,children:"Удалить"})})]},e.id))}):(0,s.jsx)("ul",{className:_().empty_product,children:(0,s.jsx)("p",{className:_().empty_description,children:"В корзине нет товаров"})})})}},3364:function(e,t,r){"use strict";r.r(t),r.d(t,{Shopping_cart_button:function(){return m}});var s=r(3827),o=r(4090),c=r(1748),n=r(9479),i=r.n(n),_=r(3105),l=r(7368),a=r(5838),d=r(9626),p=r.n(d);let u=e=>{let[t,r]=(0,o.useState)({address:""}),[n,i]=(0,o.useState)(""),[l,a]=(0,o.useState)([]),[d,u]=(0,o.useState)(0);(0,o.useEffect)(()=>{let e=_.I.onAuthStateChanged(e=>{e?m(e.uid):(a([]),u(0))}),t=(0,c.jM)((0,c.iH)(_.db,"product"),()=>{let e=_.I.currentUser;e&&m(e.uid)});return()=>{e(),t()}},[]);let m=async e=>{try{let t=(0,c.iH)(_.db,"product"),r=(0,c.IO)(t,(0,c.g2)("userId"),(0,c.EW)(e));await new Promise(e=>{(0,c.jM)(r,t=>{if(t.exists()){let r=[];t.forEach(e=>{r.push({id:e.key,...e.val()})}),a(r),f(r),e()}else a([]),u(0),console.log("Данные не найдены"),e()})})}catch(e){console.error("Ошибка при получении данных: ",e)}},f=e=>{u(e.reduce((e,t)=>e+parseFloat(t.price),0))},h=async()=>{try{let e=_.I.currentUser;if(e){let t=(0,c.iH)(_.db,"product"),r=(0,c.IO)(t,(0,c.g2)("userId"),(0,c.EW)(e.uid));await new Promise(e=>{(0,c.jM)(r,t=>{if(t.exists()){let r={};t.forEach(e=>{r["product/".concat(e.key)]=null});let s=(0,c.iH)(_.db);(0,c.Vx)(s,r).then(()=>{console.log("Все записи пользователя из базы данных 'product' удалены"),e()})}else console.log("Данные не найдены"),e()})})}}catch(e){console.error("Ошибка при удалении записей: ",e)}},v=async s=>{if(s.preventDefault(),t.address)try{let s=_.I.currentUser;if(s){let o=(0,c.VF)((0,c.iH)(_.db,"delivery")).key,n={address:t.address,userId:s.uid,price:d};await (0,c.t8)((0,c.iH)(_.db,"delivery/".concat(o)),n),r({address:""}),i(""),e.close(),await h(),window.location.reload(),alert("Ваш заказ принят")}}catch(e){console.error("Ошибка при добавлении документа: ",e)}else i("Пожалуйста, заполните поле"),setTimeout(()=>{i("")},5e3)};return(0,s.jsxs)("form",{className:p().form,children:[(0,s.jsx)("h2",{className:p().form__title,children:"Доставка"}),(0,s.jsxs)("div",{className:p().form__fields,children:[(0,s.jsxs)("label",{className:p().form__field,children:[(0,s.jsx)("span",{className:p()["form__field-title"],children:"Адрес"}),(0,s.jsx)("input",{className:p()["form__field-input"],type:"street",value:t.address,placeholder:"Ул.Мира 156, кв.45",onChange:e=>r({...t,address:e.target.value})})]}),(0,s.jsxs)("label",{className:p().form__field,children:[(0,s.jsx)("span",{className:p()["form__field-title"],children:"Способ оплаты"}),(0,s.jsx)("input",{className:p()["form__field-input"],type:"text",disabled:!0,placeholder:"при получении"})]}),(0,s.jsxs)("div",{className:p().order,children:[(0,s.jsx)("p",{className:p().order_content,children:"Стоимость заказа"}),(0,s.jsxs)("p",{className:p().order_content,children:[d,"₽"]})]})]}),n&&(0,s.jsx)("p",{className:p().error_message,children:n}),(0,s.jsx)("div",{className:p().form__actions,children:(0,s.jsx)("button",{onClick:v,className:p().form__submit,children:"Заказать"})})]})},m=()=>{let[e,t]=(0,o.useState)([]),[r,n]=(0,o.useState)(0),[d,p]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=_.I.onAuthStateChanged(e=>{e?m(e.uid):t([])});return()=>e()},[]);let m=async e=>{let r=(0,c.iH)(_.db,"product"),s=(0,c.IO)(r,(0,c.g2)("userId"),(0,c.EW)(e));try{(0,c.jM)(s,e=>{if(e.exists()){let r=[];e.forEach(e=>{r.push({id:e.key,...e.val()})}),t(r)}else t([])})}catch(e){console.error("Ошибка при получении данных: ",e)}};(0,o.useEffect)(()=>{n(e.reduce((e,t)=>e+parseFloat(t.price),0))},[e]);let f=()=>{p(!1)};return(0,s.jsxs)("div",{className:i().shopping_cart_button,children:[e.length>0?(0,s.jsxs)("button",{className:i().order_button,onClick:()=>{p(!0)},children:[(0,s.jsx)("p",{className:i().order_content,children:"Заказать"}),(0,s.jsxs)("p",{className:i().order_content,children:[r,"₽"]})]}):"",(0,s.jsx)(l.a,{isOpened:d,close:f}),(0,s.jsx)(a.G,{isOpened:d,close:f,children:(0,s.jsx)(u,{close:f})})]})}},3105:function(e,t,r){"use strict";r.d(t,{I:function(){return i},db:function(){return _}});var s=r(6142),o=r(2730),c=r(1748);let n=(0,s.ZF)({apiKey:"AIzaSyDO_-hjElfDwtU1ESVRSFt8hZJ7IIMwlno",authDomain:"best-rest-99119.firebaseapp.com",databaseURL:"https://best-rest-99119-default-rtdb.europe-west1.firebasedatabase.app",projectId:"best-rest-99119",storageBucket:"best-rest-99119.appspot.com",messagingSenderId:"90112321750",appId:"1:90112321750:web:2be2a6ea307df81f7b8177"}),i=(0,o.v0)(n),_=(0,c.N8)(n)},1127:function(e){e.exports={cart:"Cart_cart__WA5qe"}},9626:function(e){e.exports={form:"DeliveryForm_form__4dbC5",form__title:"DeliveryForm_form__title__bmid7",form__fields:"DeliveryForm_form__fields__Qbm39",form__field:"DeliveryForm_form__field__HHIpP","form__field-title":"DeliveryForm_form__field-title__z_ZFu","form__field-input":"DeliveryForm_form__field-input__AQ_bq",form__actions:"DeliveryForm_form__actions____vdd",order:"DeliveryForm_order__Mym0G",order_content:"DeliveryForm_order_content__9HDdM",form__submit:"DeliveryForm_form__submit__XnN9V",form__reset:"DeliveryForm_form__reset__QiYrw",form__transition:"DeliveryForm_form__transition__GsOSp",error_message:"DeliveryForm_error_message__VBoyi"}},3744:function(e){e.exports={overlay:"Overlay_overlay__87APJ","overlay_is-opened":"Overlay_overlay_is-opened__QKW4v"}},4487:function(e){e.exports={popup:"Popup_popup__lJxRt","popup_is-opened":"Popup_popup_is-opened__R8NFO",close:"Popup_close__efpry","close-icon":"Popup_close-icon__QfKYp"}},3033:function(e){e.exports={shopping_cart:"Shopping_cart_shopping_cart__C97dj",ul_product:"Shopping_cart_ul_product__vJXZs",product:"Shopping_cart_product__2_icS",product_content:"Shopping_cart_product_content__8nnn5",product_description:"Shopping_cart_product_description__aCDUV",button_remove:"Shopping_cart_button_remove__iN166",remove_text:"Shopping_cart_remove_text__499iC",empty_product:"Shopping_cart_empty_product__rOt_y",empty_description:"Shopping_cart_empty_description__3Hl1T"}},9479:function(e){e.exports={shopping_cart_button:"Shopping_cart_button_shopping_cart_button__Fr7N4",order_button:"Shopping_cart_button_order_button__X6pF0",order_content:"Shopping_cart_button_order_content__SSsm3"}}},function(e){e.O(0,[481,807,168,971,69,744],function(){return e(e.s=1788)}),_N_E=e.O()}]);